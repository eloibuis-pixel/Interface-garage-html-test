<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GarageAI â€” Tableau de bord</title>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Syne:wght@700;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{font-family:'DM Sans',sans-serif;background:#f1f5f9;overflow:hidden;height:100vh}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:99px}
@keyframes pg{0%,100%{box-shadow:0 0 0 0 rgba(34,197,94,.5)}50%{box-shadow:0 0 0 6px rgba(34,197,94,0)}}
@keyframes rg{0%{transform:rotate(0deg)}10%{transform:rotate(-15deg)}20%{transform:rotate(15deg)}30%{transform:rotate(-10deg)}40%{transform:rotate(10deg)}50%,100%{transform:rotate(0deg)}}
@keyframes fu{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.pdot{animation:pg 2s infinite}.ringing{display:inline-block;animation:rg 1s infinite}.fup{animation:fu .3s ease both}
table{border-collapse:collapse;width:100%}input:focus{outline:none}button{font-family:'DM Sans',sans-serif;cursor:pointer}
</style>
</head>
<body>
<div id="root"></div>
<script>
window.addEventListener('load', function() {

var ce = React.createElement;
var useState = React.useState;
var useEffect = React.useEffect;
var useRef = React.useRef;

var CHART = [
  {day:'Lun 12',n:8},{day:'Mar 13',n:14},{day:'Mer 14',n:11},
  {day:'Jeu 15',n:17},{day:'Ven 16',n:22},{day:'Sam 17',n:9},{day:'Dim 18',n:3}
];

var CALLS = [
  {id:1,co:'Transports Dupont',res:'Bruit moteur anormal',prob:'Claquement dÃ©marrage Ã  froid, possible distribution',rdv:'2025-02-18T09:30',tel:'06 12 34 56 78'},
  {id:2,co:'BTP Marchand SARL',res:'Voyant moteur allumÃ©',prob:'TÃ©moin orange 3 jours, perte de puissance ressentie',rdv:'2025-02-18T11:00',tel:'07 89 01 23 45'},
  {id:3,co:'Livraisons Express 31',res:'Pneu crevÃ© sur A64',prob:'Crevaison arriÃ¨re droit, pneu de secours posÃ©',rdv:null,tel:'06 55 44 33 22'},
  {id:4,co:'Cabinet Notarial LÃ©on',res:'Vidange + rÃ©vision',prob:'VÃ©hicule Ã  45 000 km, rÃ©vision complÃ¨te demandÃ©e',rdv:'2025-02-19T14:00',tel:'05 61 78 90 12'},
  {id:5,co:'Agence ImmobiliÃ¨re Sud',res:'Freins qui crissent',prob:'Bruit mÃ©tallique au freinage, plaquettes Ã  vÃ©rifier',rdv:'2025-02-20T10:00',tel:'06 33 22 11 00'},
  {id:6,co:'Menuiserie Fabre',res:'Climatisation en panne',prob:'Clim ne refroidit plus depuis la semaine derniÃ¨re',rdv:null,tel:'06 77 66 55 44'}
];

var RDV = {
  '2025-02-18':[
    {t:'09:30',dur:60,cl:'Transports Dupont',det:'Bruit moteur â€“ Diagnostic'},
    {t:'11:00',dur:90,cl:'BTP Marchand SARL',det:'Voyant moteur â€“ ContrÃ´le OBD'},
    {t:'14:30',dur:45,cl:'Auto Ã‰cole Martin',det:'ContrÃ´le technique prÃ©ventif'},
    {t:'16:00',dur:30,cl:'SARL Constructions Nord',det:'Devis carrosserie'}
  ],
  '2025-02-19':[
    {t:'08:30',dur:120,cl:'Cabinet Notarial LÃ©on',det:'Vidange + rÃ©vision 45k km'},
    {t:'11:00',dur:60,cl:'Flotte Renault SAS',det:'Remplacement courroie'},
    {t:'15:00',dur:45,cl:'Pharmacie Centrale',det:'Diagnostic Ã©lectronique'}
  ],
  '2025-02-20':[
    {t:'10:00',dur:60,cl:'Agence ImmobiliÃ¨re Sud',det:'Freins â€“ Remplacement plaquettes'},
    {t:'13:30',dur:90,cl:'SociÃ©tÃ© GÃ©nie Civil 31',det:'BoÃ®te de vitesses â€“ Inspection'}
  ],
  '2025-02-21':[
    {t:'09:00',dur:45,cl:'Restaurant Le Quercy',det:'Batterie dÃ©chargÃ©e â€“ Remplacement'},
    {t:'14:00',dur:120,cl:'Taxi Occitanie',det:'RÃ©vision complÃ¨te + contrÃ´le'},
    {t:'16:30',dur:30,cl:'Boulangerie Moreau',det:'Pneus â€“ Permutation saisonniÃ¨re'}
  ],
  '2025-02-24':[
    {t:'10:30',dur:60,cl:'Studio Photo LumiÃ¨re',det:'Climatisation â€“ Recharge gaz'},
    {t:'15:00',dur:45,cl:'Mairie de Blagnac',det:'ContrÃ´le pÃ©riodique flotte'}
  ]
};

var SIMS = [
  {co:'Transports Leclerc & Fils',tel:'06 42 18 73 05',sit:'Claquement mÃ©tallique sous capot au dÃ©marrage',det:'RÃ©pÃ©tÃ© Ã  froid, disparaÃ®t aprÃ¨s 2 min. KM: 87 400. Renault Master 2019.',rdv:'2025-02-19T08:30'},
  {co:'SARL Ã‰lectricitÃ© Faure',tel:'07 63 29 41 87',sit:"FumÃ©e blanche Ã  l'Ã©chappement",det:"Continue depuis ce matin, consommation d'eau anormale. Suspicion joint de culasse. Peugeot Partner 2020.",rdv:null},
  {co:'Flotte VTC Toulouse',tel:'06 81 54 32 09',sit:'Vibrations au freinage haute vitesse',det:'Volant qui vibre lors freinages >100 km/h. Disques avant probablement voilÃ©s. Toyota Camry 2022.',rdv:'2025-02-20T14:30'},
  {co:'Cabinet MÃ©dical PyrÃ©nÃ©es',tel:'05 61 22 87 44',sit:'Voyant huile + tÃ©moin moteur allumÃ©s',det:'Deux tÃ©moins aprÃ¨s long trajet. Niveau huile OK mais pression faible. BMW 320d 2021.',rdv:null},
  {co:'Agence Compta Gestion Sud',tel:'06 17 93 62 58',sit:"BoÃ®te automatique qui patine 2Ã¨me-3Ã¨me",det:"Passage hÃ©sitant, odeur de brÃ»lÃ© lors accÃ©lÃ©rations. VW Passat 2018 â€“ 110 000 km.",rdv:'2025-02-21T09:00'}
];

var PROBS = [
  {lb:'Moteur / Diagnostic',n:24},{lb:'Freins',n:18},{lb:'Vidange / RÃ©vision',n:15},
  {lb:'Pneumatiques',n:12},{lb:'Climatisation',n:8},{lb:'Ã‰lectronique',n:7}
];

var MFR = ['Janvier','FÃ©vrier','Mars','Avril','Mai','Juin','Juillet','AoÃ»t','Septembre','Octobre','Novembre','DÃ©cembre'];
var DFR = ['Lun','Mar','Mer','Jeu','Ven','Sam','Dim'];

function fmtL(dt) {
  if (!dt) return null;
  var d = new Date(dt);
  return d.toLocaleDateString('fr-FR',{weekday:'long',day:'numeric',month:'long'}) + ' Ã  ' + d.toLocaleTimeString('fr-FR',{hour:'2-digit',minute:'2-digit'});
}
function fmtS(dt) {
  if (!dt) return 'â€”';
  var d = new Date(dt);
  return d.toLocaleDateString('fr-FR',{day:'2-digit',month:'2-digit'}) + ' ' + d.toLocaleTimeString('fr-FR',{hour:'2-digit',minute:'2-digit'});
}
function dkey(y,m,d) { return y+'-'+String(m+1).padStart(2,'0')+'-'+String(d).padStart(2,'0'); }

// s() helper: style object shorthand
function s(obj) { return obj; }

// â”€â”€ LINE CHART â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function LineChart(props) {
  var data = props.data;
  var tipS = useState(null); var tip = tipS[0]; var setTip = tipS[1];
  var svgRef = useRef(null);
  var W=500, H=150, PX=36, PY=18;
  var maxV = 0;
  for (var i=0; i<data.length; i++) { if (data[i].n > maxV) maxV = data[i].n; }
  function px(i) { return PX + (i/(data.length-1)) * (W-PX*2); }
  function py(v) { return PY + (1 - v/(maxV||1)) * (H-PY*2); }
  var lineD = data.map(function(d,i){ return (i===0?'M':'L') + px(i).toFixed(1) + ',' + py(d.n).toFixed(1); }).join(' ');
  var areaD = lineD + ' L' + px(data.length-1).toFixed(1) + ',' + (H-PY) + ' L' + px(0).toFixed(1) + ',' + (H-PY) + ' Z';

  return ce('div', {style:{position:'relative',width:'100%'}},
    ce('svg', {ref:svgRef, viewBox:'0 0 '+W+' '+H, style:{width:'100%',height:'auto',overflow:'visible'}},
      ce('defs', null,
        ce('linearGradient', {id:'cg',x1:'0',y1:'0',x2:'0',y2:'1'},
          ce('stop', {offset:'0%',stopColor:'#3b82f6',stopOpacity:'0.2'}),
          ce('stop', {offset:'100%',stopColor:'#3b82f6',stopOpacity:'0'})
        )
      ),
      [0,0.33,0.66,1].map(function(t,i) {
        var y = PY + t*(H-PY*2);
        return ce('g', {key:i},
          ce('line', {x1:PX,y1:y,x2:W-PX,y2:y,stroke:'#e2e8f0',strokeWidth:'1',strokeDasharray:'4,3'}),
          ce('text', {x:PX-5,y:y+4,textAnchor:'end',fontSize:'10',fill:'#94a3b8'}, String(Math.round(maxV*(1-t))))
        );
      }),
      ce('path', {d:areaD, fill:'url(#cg)'}),
      ce('path', {d:lineD, fill:'none', stroke:'#3b82f6', strokeWidth:'2.5', strokeLinecap:'round', strokeLinejoin:'round'}),
      data.map(function(d,i) {
        return ce('g', {key:i, style:{cursor:'pointer'},
          onMouseEnter: function() {
            if (!svgRef.current) return;
            var r = svgRef.current.getBoundingClientRect();
            setTip({x: px(i)*(r.width/W)+r.left, y: py(d.n)*(r.height/H)+r.top, d:d});
          },
          onMouseLeave: function() { setTip(null); }},
          ce('circle', {cx:px(i),cy:py(d.n),r:'5',fill:'#3b82f6',stroke:'white',strokeWidth:'2'}),
          ce('text', {x:px(i),y:H-3,textAnchor:'middle',fontSize:'10',fill:'#64748b'}, d.day.split(' ')[0])
        );
      })
    ),
    tip ? ce('div', {style:{position:'fixed',left:tip.x-40,top:tip.y-38,background:'#0f172a',color:'white',padding:'5px 10px',borderRadius:'8px',fontSize:'12px',pointerEvents:'none',whiteSpace:'nowrap',zIndex:9999}}, tip.d.day + ' : ' + tip.d.n + ' appels') : null
  );
}

// â”€â”€ AGENDA MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function AgendaModal(props) {
  var date = props.date;
  var onClose = props.onClose;
  var key = date.toISOString().split('T')[0];
  var rdvs = RDV[key] || [];
  var hours = [8,9,10,11,12,13,14,15,16,17,18];

  return ce('div', {onClick:onClose, style:{position:'fixed',inset:0,background:'rgba(15,23,42,.65)',zIndex:200,display:'flex',alignItems:'center',justifyContent:'center',backdropFilter:'blur(4px)'}},
    ce('div', {onClick:function(e){e.stopPropagation();}, className:'fup', style:{background:'white',borderRadius:'20px',width:'480px',maxHeight:'82vh',overflow:'hidden',boxShadow:'0 25px 60px rgba(0,0,0,.35)'}},
      ce('div', {style:{background:'#1e293b',padding:'16px 20px',display:'flex',alignItems:'center',justifyContent:'space-between'}},
        ce('div', null,
          ce('div', {style:{color:'#94a3b8',fontSize:'12px'}}, 'Agenda du'),
          ce('div', {style:{color:'white',fontWeight:700,fontSize:'16px',fontFamily:'Syne,sans-serif'}}, date.toLocaleDateString('fr-FR',{weekday:'long',day:'numeric',month:'long'}))
        ),
        ce('button', {onClick:onClose, style:{background:'#334155',border:'none',color:'white',borderRadius:'8px',width:'30px',height:'30px',fontSize:'18px',lineHeight:'1'}}, 'Ã—')
      ),
      ce('div', {style:{overflowY:'auto',maxHeight:'66vh',padding:'8px 16px 20px'}},
        rdvs.length === 0
          ? ce('div', {style:{textAlign:'center',padding:'48px 20px',color:'#94a3b8'}},
              ce('div', {style:{fontSize:'36px',marginBottom:'8px'}}, 'ðŸ“…'),
              ce('span', null, 'Aucun rendez-vous ce jour')
            )
          : hours.map(function(hr) {
              var rdv = null;
              for (var i=0; i<rdvs.length; i++) { if (parseInt(rdvs[i].t) === hr) { rdv = rdvs[i]; break; } }
              return ce('div', {key:hr, style:{display:'flex',minHeight:'50px',borderBottom:'1px solid #f1f5f9'}},
                ce('div', {style:{width:'46px',paddingTop:'10px',color:'#94a3b8',fontSize:'11px',flexShrink:0}}, hr+':00'),
                ce('div', {style:{flex:1,padding:'4px 0 4px 8px'}},
                  rdv ? ce('div', {style:{background:'#eff6ff',borderLeft:'4px solid #3b82f6',borderRadius:'10px',padding:'8px 12px'}},
                    ce('div', {style:{fontWeight:600,fontSize:'13px',color:'#1e40af'}}, rdv.t + ' â€” ' + rdv.cl),
                    ce('div', {style:{fontSize:'12px',color:'#475569',marginTop:'2px'}}, rdv.det),
                    ce('div', {style:{fontSize:'11px',color:'#94a3b8',marginTop:'2px'}}, 'â± ' + rdv.dur + ' min')
                  ) : null
                )
              );
            })
      )
    )
  );
}

// â”€â”€ CALENDAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function Calendar(props) {
  var onSel = props.onDaySelect;
  var vs = useState({y:2025,m:1}); var v=vs[0]; var setV=vs[1];
  var ss = useState(null); var sel=ss[0]; var setSel=ss[1];
  var firstDow = (function(){ var d=new Date(v.y,v.m,1).getDay(); return d===0?6:d-1; })();
  var lastD = new Date(v.y,v.m+1,0).getDate();
  var cells = [];
  for (var ii=0; ii<firstDow; ii++) cells.push(null);
  for (var dd=1; dd<=lastD; dd++) cells.push(dd);
  function hasRdv(day) { return day ? !!(RDV[dkey(v.y,v.m,day)]) : false; }
  function prev() { setV(function(x){ return x.m===0 ? {y:x.y-1,m:11} : {y:x.y,m:x.m-1}; }); }
  function next() { setV(function(x){ return x.m===11 ? {y:x.y+1,m:0} : {y:x.y,m:x.m+1}; }); }

  return ce('div', null,
    ce('div', {style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:'12px'}},
      ce('button', {onClick:prev, style:{background:'#f1f5f9',border:'none',borderRadius:'8px',width:'28px',height:'28px',color:'#475569',fontSize:'16px'}}, 'â€¹'),
      ce('span', {style:{fontWeight:700,fontSize:'14px',color:'#1e293b',fontFamily:'Syne,sans-serif'}}, MFR[v.m] + ' ' + v.y),
      ce('button', {onClick:next, style:{background:'#f1f5f9',border:'none',borderRadius:'8px',width:'28px',height:'28px',color:'#475569',fontSize:'16px'}}, 'â€º')
    ),
    ce('div', {style:{display:'grid',gridTemplateColumns:'repeat(7,1fr)',gap:'2px',marginBottom:'4px'}},
      DFR.map(function(dd){ return ce('div',{key:dd,style:{textAlign:'center',fontSize:'11px',fontWeight:600,color:'#94a3b8',padding:'3px 0'}}, dd); })
    ),
    ce('div', {style:{display:'grid',gridTemplateColumns:'repeat(7,1fr)',gap:'2px'}},
      cells.map(function(day,idx) {
        var isToday = !!(day && v.y===2025 && v.m===1 && day===18);
        var isSel = !!(day && sel===day);
        var dot = hasRdv(day);
        return ce('div', {key:idx,
          onClick: function(){ if(day){ setSel(day); onSel(new Date(v.y,v.m,day)); } },
          style:{textAlign:'center',padding:'6px 2px',borderRadius:'8px',cursor:day?'pointer':'default',
            background:isToday?'#3b82f6':isSel?'#eff6ff':'transparent',
            color:isToday?'white':day?'#1e293b':'transparent',
            fontWeight:isToday?700:400,fontSize:'13px',
            border:isSel&&!isToday?'1.5px solid #3b82f6':'1.5px solid transparent',transition:'all .15s'}},
          day || '',
          dot ? ce('div',{style:{width:'4px',height:'4px',borderRadius:'50%',background:isToday?'white':'#3b82f6',margin:'1px auto 0'}}) : null
        );
      })
    )
  );
}

// â”€â”€ CALL MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function CallModal(props) {
  var call = props.call;
  var onClose = props.onClose;
  var ss = useState('ringing'); var step=ss[0]; var setStep=ss[1];
  useEffect(function(){
    var t = setTimeout(function(){ setStep('active'); }, 2000);
    return function(){ clearTimeout(t); };
  }, []);

  return ce('div', {style:{position:'fixed',inset:0,background:'rgba(15,23,42,.75)',zIndex:300,display:'flex',alignItems:'center',justifyContent:'center',backdropFilter:'blur(6px)'}},
    ce('div', {className:'fup', style:{background:'white',borderRadius:'24px',width:'400px',boxShadow:'0 30px 80px rgba(0,0,0,.4)',overflow:'hidden'}},
      ce('div', {style:{background:step==='ringing'?'linear-gradient(135deg,#1e40af,#3b82f6)':'linear-gradient(135deg,#166534,#16a34a)',padding:'28px 24px',textAlign:'center',transition:'background .6s'}},
        ce('div', {className:step==='ringing'?'ringing':'', style:{fontSize:'40px',marginBottom:'8px',display:'inline-block'}}, step==='ringing'?'ðŸ“²':'ðŸ”§'),
        ce('div', {style:{color:'rgba(255,255,255,.75)',fontSize:'12px',marginBottom:'4px'}}, step==='ringing'?'Appel entrant simulÃ©':'Appel en cours â€” IA active'),
        ce('div', {style:{color:'white',fontWeight:700,fontSize:'20px',fontFamily:'Syne,sans-serif'}}, call.co),
        ce('div', {style:{color:'rgba(255,255,255,.85)',fontSize:'14px',marginTop:'4px'}}, call.tel)
      ),
      step==='active'
        ? ce('div', {style:{padding:'20px 24px'}},
            ce('div', {style:{background:'#fef3c7',borderRadius:'12px',padding:'12px 14px',marginBottom:'12px',borderLeft:'4px solid #f59e0b'}},
              ce('div', {style:{fontWeight:600,fontSize:'12px',color:'#92400e',marginBottom:'4px'}}, 'ðŸŽ¤ Situation signalÃ©e'),
              ce('div', {style:{fontSize:'14px',color:'#78350f',fontWeight:500}}, call.sit)
            ),
            ce('div', {style:{background:'#f8fafc',borderRadius:'12px',padding:'12px 14px',marginBottom:'12px'}},
              ce('div', {style:{fontWeight:600,fontSize:'12px',color:'#475569',marginBottom:'4px'}}, 'ðŸ“‹ Diagnostic IA'),
              ce('div', {style:{fontSize:'13px',color:'#334155',lineHeight:'1.6'}}, call.det)
            ),
            call.rdv
              ? ce('div', {style:{background:'#eff6ff',borderRadius:'12px',padding:'12px 14px',marginBottom:'16px',borderLeft:'4px solid #3b82f6'}},
                  ce('div', {style:{fontWeight:600,fontSize:'12px',color:'#1e40af',marginBottom:'2px'}}, 'ðŸ“… Rendez-vous fixÃ©'),
                  ce('div', {style:{fontSize:'14px',color:'#1d4ed8',fontWeight:600}}, fmtL(call.rdv))
                )
              : ce('div', {style:{background:'#f0fdf4',borderRadius:'12px',padding:'12px 14px',marginBottom:'16px'}},
                  ce('div', {style:{fontWeight:600,fontSize:'12px',color:'#166534',marginBottom:'2px'}}, 'ðŸ’¬ Statut'),
                  ce('div', {style:{fontSize:'13px',color:'#166534'}}, "Demande d'information â€“ pas de RDV")
                ),
            ce('button', {onClick:onClose, style:{width:'100%',background:'#1e293b',color:'white',border:'none',borderRadius:'12px',padding:'12px',fontWeight:600,fontSize:'14px'}}, "Terminer l'appel")
          )
        : ce('div', {style:{padding:'20px 24px',textAlign:'center'}},
            ce('div', {style:{color:'#64748b',fontSize:'14px',marginBottom:'16px'}}, 'Connexion en coursâ€¦'),
            ce('div', {style:{display:'flex',gap:'12px'}},
              ce('button', {onClick:onClose, style:{flex:1,background:'#fef2f2',color:'#ef4444',border:'none',borderRadius:'12px',padding:'12px',fontWeight:600}}, 'âœ• Ignorer'),
              ce('button', {onClick:function(){setStep('active');}, style:{flex:1,background:'#22c55e',color:'white',border:'none',borderRadius:'12px',padding:'12px',fontWeight:600}}, 'ðŸ“ž DÃ©crocher')
            )
          )
    )
  );
}

// â”€â”€ STATS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function Stats() {
  var maxC = 0;
  for (var i=0; i<PROBS.length; i++) { if (PROBS[i].n > maxC) maxC = PROBS[i].n; }
  return ce('div', {className:'fup'},
    ce('div', {style:{display:'grid',gridTemplateColumns:'1fr 1fr 1fr',gap:'14px',marginBottom:'20px'}},
      [{lb:'Appels ce mois',val:'84',col:'#3b82f6',ic:'ðŸ“ž'},
       {lb:'RDV confirmÃ©s',val:'31',col:'#22c55e',ic:'âœ…'},
       {lb:'Taux conversion',val:'36.9%',col:'#f59e0b',ic:'ðŸ“ˆ'}
      ].map(function(s) {
        return ce('div', {key:s.lb, style:{background:'white',borderRadius:'16px',padding:'16px',boxShadow:'0 2px 12px rgba(0,0,0,.06)'}},
          ce('div', {style:{fontSize:'24px',marginBottom:'6px'}}, s.ic),
          ce('div', {style:{fontWeight:700,fontSize:'22px',color:s.col}}, s.val),
          ce('div', {style:{fontSize:'12px',color:'#94a3b8',marginTop:'2px'}}, s.lb)
        );
      })
    ),
    ce('div', {style:{background:'white',borderRadius:'20px',padding:'20px',boxShadow:'0 2px 12px rgba(0,0,0,.06)',marginBottom:'16px'}},
      ce('div', {style:{fontWeight:700,fontSize:'15px',color:'#1e293b',marginBottom:'16px',fontFamily:'Syne,sans-serif'}}, 'Top problÃ¨mes signalÃ©s'),
      PROBS.map(function(p) {
        return ce('div', {key:p.lb, style:{marginBottom:'10px'}},
          ce('div', {style:{display:'flex',justifyContent:'space-between',marginBottom:'4px'}},
            ce('span', {style:{fontSize:'13px',color:'#334155'}}, p.lb),
            ce('span', {style:{fontSize:'13px',fontWeight:600,color:'#3b82f6'}}, String(p.n))
          ),
          ce('div', {style:{background:'#f1f5f9',borderRadius:'99px',height:'6px'}},
            ce('div', {style:{background:'#3b82f6',borderRadius:'99px',height:'6px',width:Math.round(p.n/maxC*100)+'%'}})
          )
        );
      })
    ),
    ce('div', {style:{background:'white',borderRadius:'20px',padding:'20px',boxShadow:'0 2px 12px rgba(0,0,0,.06)'}},
      ce('div', {style:{fontWeight:700,fontSize:'15px',color:'#1e293b',marginBottom:'12px',fontFamily:'Syne,sans-serif'}}, 'ActivitÃ© 7 derniers jours'),
      ce(LineChart, {data:CHART})
    )
  );
}

// â”€â”€ CALLS TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function CallsTable(props) {
  var calls = props.calls;
  var init = {};
  calls.forEach(function(c){ init[c.id] = c.prob; });
  var ps = useState(init); var probs=ps[0]; var setProbs=ps[1];
  return ce('div', {style:{background:'white',borderRadius:'24px',padding:'24px',boxShadow:'0 2px 16px rgba(0,0,0,.06)'}},
    ce('div', {style:{fontWeight:700,fontSize:'16px',color:'#1e293b',fontFamily:'Syne,sans-serif',marginBottom:'16px'}}, 'Derniers appels'),
    ce('div', {style:{overflowX:'auto'}},
      ce('table', null,
        ce('thead', null,
          ce('tr', {style:{borderBottom:'2px solid #f1f5f9'}},
            ['Entreprise','RÃ©sumÃ©','ProblÃ¨me (Ã©ditable)','Heure RDV','TÃ©lÃ©phone'].map(function(col){
              return ce('th',{key:col,style:{textAlign:'left',padding:'8px 10px',fontSize:'12px',fontWeight:600,color:'#94a3b8',whiteSpace:'nowrap'}}, col);
            })
          )
        ),
        ce('tbody', null,
          calls.map(function(call) {
            return ce('tr', {key:call.id,
              onMouseEnter:function(e){e.currentTarget.style.background='#f8fafc';},
              onMouseLeave:function(e){e.currentTarget.style.background='transparent';},
              style:{borderBottom:'1px solid #f8fafc',transition:'background .15s'}},
              ce('td', {style:{padding:'12px 10px',fontWeight:600,fontSize:'13px',color:'#1e293b',whiteSpace:'nowrap'}}, call.co),
              ce('td', {style:{padding:'12px 10px'}},
                ce('span', {style:{background:'#f1f5f9',borderRadius:'6px',padding:'3px 8px',fontSize:'12px',color:'#475569'}}, call.res)
              ),
              ce('td', {style:{padding:'12px 10px',minWidth:'200px'}},
                ce('input', {
                  value: probs[call.id] || '',
                  onChange: function(e){ var v=e.target.value; var id=call.id; setProbs(function(p){ var n=Object.assign({},p); n[id]=v; return n; }); },
                  style:{border:'1px solid #e2e8f0',borderRadius:'8px',padding:'5px 8px',fontSize:'12px',color:'#334155',width:'100%',background:'#fafafa',fontFamily:'DM Sans,sans-serif'},
                  onFocus:function(e){e.target.style.border='1px solid #3b82f6';e.target.style.background='white';},
                  onBlur:function(e){e.target.style.border='1px solid #e2e8f0';e.target.style.background='#fafafa';}
                })
              ),
              ce('td', {style:{padding:'12px 10px',fontSize:'13px',whiteSpace:'nowrap',color:call.rdv?'#1d4ed8':'#94a3b8',fontWeight:call.rdv?600:400}}, fmtS(call.rdv)),
              ce('td', {style:{padding:'12px 10px',fontSize:'13px',color:'#475569',whiteSpace:'nowrap'}}, call.tel)
            );
          })
        )
      )
    )
  );
}

// â”€â”€ APP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function App() {
  var ts = useState('dashboard'); var tab=ts[0]; var setTab=ts[1];
  var sc = useState(null); var simCall=sc[0]; var setSimCall=sc[1];
  var ag = useState(null); var agDate=ag[0]; var setAgDate=ag[1];

  var NAV = [
    {id:'dashboard',lb:'Tableau de bord',ic:'âŠž'},
    {id:'calls',lb:'Appels',ic:'ðŸ“ž'},
    {id:'clients',lb:'Clients',ic:'ðŸ‘¥'},
    {id:'stats',lb:'Statistiques',ic:'ðŸ“Š'}
  ];
  function sim() { setSimCall(SIMS[Math.floor(Math.random()*SIMS.length)]); }
  var curLabel = '';
  for (var i=0; i<NAV.length; i++) { if (NAV[i].id===tab) { curLabel=NAV[i].lb; break; } }

  return ce('div', {style:{display:'flex',height:'100vh',fontFamily:'DM Sans,sans-serif',background:'#f1f5f9'}},

    ce('aside', {style:{width:'220px',background:'#0f172a',display:'flex',flexDirection:'column',padding:'24px 16px',flexShrink:0}},
      ce('div', {style:{marginBottom:'32px'}},
        ce('div', {style:{fontFamily:'Syne,sans-serif',fontWeight:800,fontSize:'20px',color:'white'}},
          'Garage',
          ce('span', {style:{color:'#3b82f6'}}, '.'),
          ce('span', {style:{color:'#60a5fa'}}, 'AI')
        ),
        ce('div', {style:{color:'#475569',fontSize:'11px',marginTop:'2px'}}, 'Gestionnaire Automobile')
      ),
      ce('nav', {style:{flex:1}},
        NAV.map(function(item) {
          var active = tab===item.id;
          return ce('button', {key:item.id, onClick:function(){setTab(item.id);},
            style:{display:'flex',alignItems:'center',gap:'10px',width:'100%',padding:'10px 12px',borderRadius:'12px',border:'none',
              background:active?'#1e40af':'transparent',color:active?'white':'#94a3b8',
              fontWeight:active?600:400,fontSize:'14px',marginBottom:'4px',textAlign:'left',transition:'all .2s'}},
            ce('span', {style:{fontSize:'16px'}}, item.ic),
            item.lb
          );
        })
      ),
      ce('button', {onClick:sim, style:{background:'linear-gradient(135deg,#2563eb,#7c3aed)',color:'white',border:'none',borderRadius:'14px',padding:'14px 12px',fontWeight:700,fontSize:'13px',width:'100%',boxShadow:'0 4px 20px rgba(59,130,246,.4)',display:'flex',alignItems:'center',justifyContent:'center',gap:'8px'}},
        'ðŸ“² Simuler Appel'
      ),
      ce('div', {style:{marginTop:'14px',display:'flex',alignItems:'center',gap:'8px',padding:'10px 12px',background:'#1e293b',borderRadius:'12px'}},
        ce('div', {className:'pdot', style:{width:'8px',height:'8px',background:'#22c55e',borderRadius:'50%',flexShrink:0}}),
        ce('div', null,
          ce('div', {style:{color:'white',fontSize:'12px',fontWeight:600}}, 'IA en ligne'),
          ce('div', {style:{color:'#475569',fontSize:'10px'}}, 'n8n Â· actif')
        )
      )
    ),

    ce('main', {style:{flex:1,overflow:'auto',padding:'24px',display:'flex',flexDirection:'column'}},
      ce('div', {style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:'24px'}},
        ce('div', null,
          ce('h1', {style:{fontFamily:'Syne,sans-serif',fontWeight:800,fontSize:'26px',color:'#0f172a',letterSpacing:'-.5px'}}, curLabel),
          ce('p', {style:{color:'#64748b',fontSize:'14px',marginTop:'2px'}}, 'Mardi 18 fÃ©vrier 2025 Â· Bienvenue sur votre tableau de bord')
        ),
        ce('button', {style:{background:'#3b82f6',color:'white',border:'none',borderRadius:'12px',padding:'10px 18px',fontWeight:600,fontSize:'14px',boxShadow:'0 4px 14px rgba(59,130,246,.35)'}}, '+ Nouvel Appel')
      ),

      tab==='dashboard' ? ce('div', {style:{display:'grid',gridTemplateColumns:'1fr 300px',gap:'20px'}},
        ce('div', {style:{display:'flex',flexDirection:'column',gap:'20px'}},
          ce('div', {style:{background:'white',borderRadius:'24px',padding:'24px',boxShadow:'0 2px 16px rgba(0,0,0,.06)'}},
            ce('div', {style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:'20px'}},
              ce('div', null,
                ce('div', {style:{fontWeight:700,fontSize:'16px',color:'#1e293b',fontFamily:'Syne,sans-serif'}}, 'ActivitÃ© des appels'),
                ce('div', {style:{color:'#94a3b8',fontSize:'13px',marginTop:'2px'}}, '7 derniers jours Â· 84 appels ce mois')
              ),
              ce('span', {style:{background:'#eff6ff',color:'#3b82f6',fontSize:'12px',padding:'4px 10px',borderRadius:'99px',fontWeight:600}}, 'ðŸ“ˆ Semaine en cours')
            ),
            ce(LineChart, {data:CHART})
          ),
          ce(CallsTable, {calls:CALLS})
        ),
        ce('div', {style:{display:'flex',flexDirection:'column',gap:'16px'}},
          ce('div', {style:{background:'white',borderRadius:'24px',padding:'20px',boxShadow:'0 2px 16px rgba(0,0,0,.06)'}},
            ce('div', {style:{fontWeight:700,fontSize:'15px',color:'#1e293b',fontFamily:'Syne,sans-serif',marginBottom:'14px'}}, 'Calendrier'),
            ce(Calendar, {onDaySelect:function(dt){setAgDate(dt);}}),
            ce('div', {style:{marginTop:'10px',padding:'8px 10px',background:'#f8fafc',borderRadius:'10px',fontSize:'12px',color:'#64748b',textAlign:'center'}}, 'Cliquez sur un jour pour voir les RDV')
          ),
          ce('div', {style:{background:'white',borderRadius:'24px',padding:'20px',boxShadow:'0 2px 16px rgba(0,0,0,.06)'}},
            ce('div', {style:{display:'flex',alignItems:'center',gap:'8px',marginBottom:'14px'}},
              ce('div', {className:'pdot', style:{width:'10px',height:'10px',background:'#22c55e',borderRadius:'50%',flexShrink:0}}),
              ce('span', {style:{fontWeight:700,fontSize:'15px',color:'#1e293b',fontFamily:'Syne,sans-serif'}}, 'IA en ligne')
            ),
            [['ModÃ¨le','GPT-4o via n8n'],['Webhook','ConnectÃ© âœ“'],['RÃ©ponse moy.','1.4s'],['Appels traitÃ©s','84 ce mois']].map(function(row){
              return ce('div', {key:row[0], style:{display:'flex',justifyContent:'space-between',fontSize:'13px',marginBottom:'6px'}},
                ce('span', {style:{color:'#94a3b8'}}, row[0]),
                ce('span', {style:{color:'#1e293b',fontWeight:500}}, row[1])
              );
            })
          ),
          ce('button', {onClick:function(){setTab('stats');}, style:{background:'linear-gradient(135deg,#0f172a,#1e293b)',color:'white',border:'none',borderRadius:'20px',padding:'16px',cursor:'pointer',textAlign:'left',boxShadow:'0 4px 16px rgba(0,0,0,.15)',width:'100%'}},
            ce('div', {style:{fontSize:'24px',marginBottom:'6px'}}, 'ðŸ“Š'),
            ce('div', {style:{fontWeight:700,fontFamily:'Syne,sans-serif',fontSize:'14px',marginBottom:'4px'}}, 'Voir les statistiques'),
            ce('div', {style:{fontSize:'12px',color:'#94a3b8'}}, 'Conversion, top problÃ¨mes, tendances')
          )
        )
      ) : null,

      tab==='stats' ? ce(Stats, null) : null,
      tab==='calls' ? ce('div', {className:'fup'}, ce(CallsTable, {calls:CALLS})) : null,
      tab==='clients' ? ce('div', {className:'fup', style:{display:'grid',gridTemplateColumns:'repeat(3,1fr)',gap:'16px'}},
        CALLS.map(function(call) {
          return ce('div', {key:call.id, style:{background:'white',borderRadius:'20px',padding:'20px',boxShadow:'0 2px 12px rgba(0,0,0,.06)'}},
            ce('div', {style:{width:'44px',height:'44px',background:'#eff6ff',borderRadius:'12px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'20px',marginBottom:'12px'}}, 'ðŸ¢'),
            ce('div', {style:{fontWeight:700,fontSize:'15px',color:'#1e293b',marginBottom:'4px'}}, call.co),
            ce('div', {style:{fontSize:'13px',color:'#64748b',marginBottom:'8px'}}, call.tel),
            ce('div', {style:{fontSize:'12px',color:'#475569',background:'#f8fafc',borderRadius:'8px',padding:'6px 10px',marginBottom:'6px'}}, call.res),
            call.rdv ? ce('div', {style:{fontSize:'12px',color:'#1d4ed8',fontWeight:600}}, 'ðŸ“… ' + fmtS(call.rdv)) : null
          );
        })
      ) : null
    ),

    agDate ? ce(AgendaModal, {date:agDate, onClose:function(){setAgDate(null);}}) : null,
    simCall ? ce(CallModal, {call:simCall, onClose:function(){setSimCall(null);}}) : null
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(ce(App, null));

}); // end window.load
</script>
</body>
</html> 
